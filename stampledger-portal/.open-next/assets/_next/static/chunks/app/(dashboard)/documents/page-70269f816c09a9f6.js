(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[827],{25:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(5155),r=a(2115),n=a(6052),l=a(7168),i=a(7624),o=a(9869),c=a(7434),d=a(9074),h=a(5448),u=a(2915);let m=(0,a(2895).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var x=a(2239);function y(){let{token:e}=(0,n.A)(),[t,a]=(0,r.useState)([]),[y,p]=(0,r.useState)(!0),[g,f]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w()},[e]);let w=async()=>{if(e)try{let t=await fetch("/api/documents",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();a(e.documents)}}catch(e){console.error("Failed to fetch documents:",e)}finally{p(!1)}},k=async t=>{if(e){f(!0);try{let a=await (0,x.mk)(t),s=new FormData;s.append("file",t),s.append("sha256Hash",a),(await fetch("/api/documents/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:s})).ok&&await w()}catch(e){console.error("Failed to upload document:",e)}finally{f(!1)}}},b=(0,r.useCallback)(e=>{e.preventDefault(),j(!1);let t=e.dataTransfer.files[0];t&&k(t)},[e]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-header mb-0",children:"Documents"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Store and manage your engineering documents securely"})]}),(0,s.jsx)("div",{onDrop:b,onDragOver:e=>{e.preventDefault(),j(!0)},onDragLeave:()=>j(!1),className:"relative border-2 border-dashed rounded-xl p-8 text-center transition-colors ".concat(v?"border-cta bg-cta/5":"border-gray-300 hover:border-cta/50"),children:g?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(i.A,{className:"h-12 w-12 animate-spin text-cta mx-auto"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Uploading and hashing document..."})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto",children:(0,s.jsx)(o.A,{className:"h-8 w-8 text-gray-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:"Drop your document here"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"or click to browse (PDF, DWG, images)"})]}),(0,s.jsx)("input",{type:"file",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&k(a)},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:".pdf,.dwg,.png,.jpg,.jpeg"})]})}),y?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(i.A,{className:"h-8 w-8 animate-spin text-primary"})}):0===t.length?(0,s.jsxs)("div",{className:"card text-center py-12",children:[(0,s.jsx)(c.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"No documents yet"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Upload your first document to get started"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Your Documents (",t.length,")"]}),(0,s.jsx)("div",{className:"grid gap-4",children:t.map(e=>{var t;return(0,s.jsx)("div",{className:"card-hover",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"bg-secondary/10 p-3 rounded-lg",children:(0,s.jsx)(c.A,{className:"h-6 w-6 text-secondary"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.filename}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[(0,s.jsx)("span",{children:(t=e.size)<1024?t+" B":t<1048576?(t/1024).toFixed(1)+" KB":(t/1024/1024).toFixed(2)+" MB"}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(d.A,{className:"h-3 w-3 mr-1"}),new Date(e.createdAt).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,s.jsx)(h.A,{className:"h-3 w-3 text-gray-400"}),(0,s.jsxs)("code",{className:"text-xs text-gray-500 font-mono truncate",children:[e.sha256Hash.slice(0,32),"..."]})]}),e.ipfsHash&&(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)(u.A,{className:"h-3 w-3 text-accent"}),(0,s.jsx)("span",{className:"text-xs text-accent",children:"Pinned to IPFS"})]})]}),(0,s.jsx)(l.$,{variant:"ghost",size:"icon",children:(0,s.jsx)(m,{className:"h-4 w-4"})})]})},e.id)})})]})]})}},2239:(e,t,a)=>{"use strict";async function s(e){let t=await e.arrayBuffer();return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}a.d(t,{mk:()=>s})},2915:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(2596),r=a(9688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},5448:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},6052:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,AuthProvider:()=>i});var s=a(5155),r=a(2115),n=a(5695);let l=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[d,h]=(0,r.useState)(!0),u=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("token");e?(c(e),m(e)):h(!1)},[]);let m=async e=>{try{let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();i(e.user)}else localStorage.removeItem("token"),c(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("token"),c(null)}finally{h(!1)}},x=async(e,t)=>{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!a.ok)throw Error((await a.json()).error||"Login failed");let s=await a.json();localStorage.setItem("token",s.token),c(s.token),i(s.user),u.push("/")},y=async e=>{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Registration failed");let a=await t.json();localStorage.setItem("token",a.token),c(a.token),i(a.user),u.push("/")};return(0,s.jsx)(l.Provider,{value:{user:a,token:o,loading:d,login:x,register:y,logout:()=>{localStorage.removeItem("token"),c(null),i(null),u.push("/login")}},children:t})}function o(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6907:(e,t,a)=>{Promise.resolve().then(a.bind(a,25))},7168:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(5155),r=a(2115),n=a(2085),l=a(3999);let i=(0,n.F)("inline-flex items-center justify-center rounded-lg font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-cta text-white hover:bg-cta-hover shadow-md hover:shadow-lg focus-visible:ring-cta",secondary:"border-2 border-primary text-primary hover:bg-primary hover:text-white",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"hover:bg-gray-100 text-gray-700",link:"text-cta underline-offset-4 hover:underline",accent:"bg-accent text-white hover:bg-accent-dark shadow-md hover:shadow-lg",teal:"bg-secondary text-white hover:bg-secondary-dark shadow-md hover:shadow-lg",danger:"bg-red-600 text-white hover:bg-red-700 shadow-md hover:shadow-lg"},size:{default:"px-6 py-3",sm:"px-4 py-2 text-sm",lg:"px-8 py-4 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,...o}=e;return(0,s.jsx)("button",{className:(0,l.cn)(i({variant:r,size:n,className:a})),ref:t,...o})});o.displayName="Button"},7434:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7624:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9074:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9869:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},e=>{e.O(0,[987,441,964,358],()=>e(e.s=6907)),_N_E=e.O()}]);