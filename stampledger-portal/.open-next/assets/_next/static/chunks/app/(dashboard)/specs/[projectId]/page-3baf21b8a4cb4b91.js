(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[836],{2239:(e,t,s)=>{"use strict";async function a(e){let t=await e.arrayBuffer();return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}s.d(t,{mk:()=>a})},2775:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},3999:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2596),r=s(9688);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},4416:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5169:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5448:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},6052:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>n});var a=s(5155),r=s(2115),l=s(5695);let i=(0,r.createContext)(void 0);function n(e){let{children:t}=e,[s,n]=(0,r.useState)(null),[c,o]=(0,r.useState)(null),[d,h]=(0,r.useState)(!0),x=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("token");e?(o(e),u(e)):h(!1)},[]);let u=async e=>{try{let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e.user)}else localStorage.removeItem("token"),o(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("token"),o(null)}finally{h(!1)}},m=async(e,t)=>{let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!s.ok)throw Error((await s.json()).error||"Login failed");let a=await s.json();localStorage.setItem("token",a.token),o(a.token),n(a.user),x.push("/")},y=async e=>{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Registration failed");let s=await t.json();localStorage.setItem("token",s.token),o(s.token),n(s.user),x.push("/")};return(0,a.jsx)(i.Provider,{value:{user:s,token:c,loading:d,login:m,register:y,logout:()=>{localStorage.removeItem("token"),o(null),n(null),x.push("/login")}},children:t})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7168:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(5155),r=s(2115),l=s(2085),i=s(3999);let n=(0,l.F)("inline-flex items-center justify-center rounded-lg font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-cta text-white hover:bg-cta-hover shadow-md hover:shadow-lg focus-visible:ring-cta",secondary:"border-2 border-primary text-primary hover:bg-primary hover:text-white",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"hover:bg-gray-100 text-gray-700",link:"text-cta underline-offset-4 hover:underline",accent:"bg-accent text-white hover:bg-accent-dark shadow-md hover:shadow-lg",teal:"bg-secondary text-white hover:bg-secondary-dark shadow-md hover:shadow-lg",danger:"bg-red-600 text-white hover:bg-red-700 shadow-md hover:shadow-lg"},size:{default:"px-6 py-3",sm:"px-4 py-2 text-sm",lg:"px-8 py-4 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,...c}=e;return(0,a.jsx)("button",{className:(0,i.cn)(n({variant:r,size:l,className:s})),ref:t,...c})});c.displayName="Button"},7624:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9560:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(5155),r=s(2115),l=s(5695),i=s(6052),n=s(7168),c=s(9852),o=s(7624),d=s(5169),h=s(4616),x=s(2775);let u=(0,s(2895).A)("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);var m=s(9074),y=s(5448),p=s(4416),f=s(9869),g=s(2239);function v(e){let{params:t}=e,{projectId:s}=(0,r.use)(t),v=(0,l.useRouter)(),{token:b}=(0,i.A)(),[j,w]=(0,r.useState)(null),[N,k]=(0,r.useState)([]),[A,S]=(0,r.useState)(!0),[C,z]=(0,r.useState)(!1),[M,P]=(0,r.useState)(!1),[E,I]=(0,r.useState)(""),[O,F]=(0,r.useState)(""),[H,V]=(0,r.useState)(null),[B,T]=(0,r.useState)("");(0,r.useEffect)(()=>{$()},[s,b]);let $=async()=>{if(b)try{let e=await fetch("/api/specs/projects/".concat(s),{headers:{Authorization:"Bearer ".concat(b)}});if(e.ok){let t=await e.json();w(t.project),k(t.versions)}else v.push("/specs")}catch(e){console.error("Failed to fetch project:",e)}finally{S(!1)}},_=(0,r.useCallback)(async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){V(s);try{let e=await (0,g.mk)(s);T(e)}catch(e){console.error("Failed to hash file:",e)}}},[]),L=async()=>{if(b&&E&&B){P(!0);try{(await fetch("/api/specs/versions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(b)},body:JSON.stringify({projectId:s,version:E,specHash:B,changelog:O||null})})).ok&&(await $(),z(!1),I(""),F(""),V(null),T(""))}catch(e){console.error("Failed to create version:",e)}finally{P(!1)}}};return A?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(o.A,{className:"h-8 w-8 animate-spin text-primary"})}):j?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>v.push("/specs"),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-primary",children:j.name}),j.description&&(0,a.jsx)("p",{className:"text-gray-600",children:j.description})]}),(0,a.jsxs)(n.$,{onClick:()=>{I((()=>{if(0===N.length)return"1.0.0";let e=N[0].version,t=e.split(".").map(Number);return 3===t.length?(t[2]++,t.join(".")):"".concat(e,".1")})()),z(!0)},children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"New Version"]})]}),0===N.length?(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)(x.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"No versions yet"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create the first version of this specification"}),(0,a.jsxs)(n.$,{onClick:()=>{I("1.0.0"),z(!0)},className:"mt-4",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Create Version 1.0.0"]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Version History (",N.length,")"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"}),(0,a.jsx)("div",{className:"space-y-4",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"relative flex gap-4",children:[(0,a.jsx)("div",{className:"relative z-10 w-12 h-12 rounded-full flex items-center justify-center ".concat(0===t?"bg-accent text-white":"bg-gray-200 text-gray-600"),children:(0,a.jsx)(u,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1 card",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-mono font-semibold ".concat(0===t?"bg-accent/10 text-accent":"bg-gray-100 text-gray-600"),children:["v",e.version]}),0===t&&(0,a.jsx)("span",{className:"ml-2 text-xs text-accent font-medium",children:"Latest"})]}),(0,a.jsxs)("span",{className:"flex items-center text-sm text-gray-500",children:[(0,a.jsx)(m.A,{className:"h-3 w-3 mr-1"}),new Date(e.createdAt).toLocaleDateString()]})]}),e.changelog&&(0,a.jsx)("p",{className:"mt-3 text-gray-700",children:e.changelog}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-500",children:[(0,a.jsx)(y.A,{className:"h-3 w-3"}),(0,a.jsxs)("code",{className:"font-mono",children:[e.specHash.slice(0,32),"..."]})]})]})]},e.id))})]})]}),C&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Version"}),(0,a.jsx)("button",{onClick:()=>z(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"input-label",children:"Version Number *"}),(0,a.jsx)(c.p,{placeholder:"e.g., 1.0.0",value:E,onChange:e=>I(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"input-label",children:"Specification File *"}),(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-4 text-center ".concat(H?"border-accent bg-accent/5":"border-gray-300"),children:[H?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:H.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:[B.slice(0,32),"..."]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.A,{className:"h-6 w-6 text-gray-400 mx-auto"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Click to upload spec file"})]}),(0,a.jsx)("input",{type:"file",onChange:_,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",style:{position:"relative"}})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"input-label",children:"Changelog"}),(0,a.jsx)("textarea",{className:"flex w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-base placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cta focus-visible:ring-offset-2",rows:3,placeholder:"What changed in this version...",value:O,onChange:e=>F(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end mt-6",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),(0,a.jsx)(n.$,{onClick:L,disabled:!E||!B||M,children:M?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Version"})]})]})})]}):null}},9677:(e,t,s)=>{Promise.resolve().then(s.bind(s,9560))},9852:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(5155),r=s(2115),l=s(3999);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-12 w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cta focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},9869:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2895).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},e=>{e.O(0,[987,441,964,358],()=>e(e.s=9677)),_N_E=e.O()}]);