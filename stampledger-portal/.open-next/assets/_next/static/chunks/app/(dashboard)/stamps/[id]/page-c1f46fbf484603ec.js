(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{311:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},809:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2915:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3786:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(2596),r=a(9688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},5169:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6052:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,AuthProvider:()=>n});var s=a(5155),r=a(2115),l=a(5695);let i=(0,r.createContext)(void 0);function n(e){let{children:t}=e,[a,n]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[o,m]=(0,r.useState)(!0),h=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("token");e?(d(e),x(e)):m(!1)},[]);let x=async e=>{try{let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e.user)}else localStorage.removeItem("token"),d(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("token"),d(null)}finally{m(!1)}},u=async(e,t)=>{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!a.ok)throw Error((await a.json()).error||"Login failed");let s=await a.json();localStorage.setItem("token",s.token),d(s.token),n(s.user),h.push("/")},p=async e=>{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Registration failed");let a=await t.json();localStorage.setItem("token",a.token),d(a.token),n(a.user),h.push("/")};return(0,s.jsx)(i.Provider,{value:{user:a,token:c,loading:o,login:u,register:p,logout:()=>{localStorage.removeItem("token"),d(null),n(null),h.push("/login")}},children:t})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7130:(e,t,a)=>{Promise.resolve().then(a.bind(a,9104))},7168:(e,t,a)=>{"use strict";a.d(t,{$:()=>c});var s=a(5155),r=a(2115),l=a(2085),i=a(3999);let n=(0,l.F)("inline-flex items-center justify-center rounded-lg font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-cta text-white hover:bg-cta-hover shadow-md hover:shadow-lg focus-visible:ring-cta",secondary:"border-2 border-primary text-primary hover:bg-primary hover:text-white",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"hover:bg-gray-100 text-gray-700",link:"text-cta underline-offset-4 hover:underline",accent:"bg-accent text-white hover:bg-accent-dark shadow-md hover:shadow-lg",teal:"bg-secondary text-white hover:bg-secondary-dark shadow-md hover:shadow-lg",danger:"bg-red-600 text-white hover:bg-red-700 shadow-md hover:shadow-lg"},size:{default:"px-6 py-3",sm:"px-4 py-2 text-sm",lg:"px-8 py-4 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,...c}=e;return(0,s.jsx)("button",{className:(0,i.cn)(n({variant:r,size:l,className:a})),ref:t,...c})});c.displayName="Button"},7624:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2895).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9104:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(5155),r=a(2115),l=a(5695),i=a(6052),n=a(7168),c=a(7624),d=a(5169),o=a(2915),m=a(311),h=a(809);let x=(0,a(2895).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var u=a(3786);function p(e){let{params:t}=e,{id:a}=(0,r.use)(t),p=(0,l.useRouter)(),{token:g}=(0,i.A)(),[y,f]=(0,r.useState)(null),[j,v]=(0,r.useState)(!0),[N,b]=(0,r.useState)(!1),[k,w]=(0,r.useState)(!1),[A,S]=(0,r.useState)(""),[C,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{z()},[a,g]);let z=async()=>{if(g)try{let e=await fetch("/api/stamps/".concat(a),{headers:{Authorization:"Bearer ".concat(g)}});if(e.ok){let t=await e.json();f(t.stamp)}else p.push("/stamps")}catch(e){console.error("Failed to fetch stamp:",e)}finally{v(!1)}},T=async()=>{if(g&&A){b(!0);try{let e=await fetch("/api/stamps/".concat(a),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(g)},body:JSON.stringify({reason:A})});if(e.ok){let t=await e.json();f(t.stamp),w(!1)}}catch(e){console.error("Failed to revoke stamp:",e)}finally{b(!1)}}};return j?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(c.A,{className:"h-8 w-8 animate-spin text-primary"})}):y?(0,s.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>p.back(),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)(d.A,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-primary",children:y.projectName||"Stamp Details"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Created ",new Date(y.createdAt).toLocaleString()]})]}),"active"===y.status?(0,s.jsxs)("span",{className:"flex items-center px-3 py-1 bg-accent/10 text-accent rounded-full text-sm font-medium",children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Active"]}):(0,s.jsxs)("span",{className:"flex items-center px-3 py-1 bg-red-100 text-red-600 rounded-full text-sm font-medium",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-1"}),"Revoked"]})]}),"revoked"===y.status&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(h.A,{className:"h-5 w-5 text-red-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-red-800",children:"This stamp has been revoked"}),(0,s.jsxs)("p",{className:"text-sm text-red-600 mt-1",children:["Reason: ",y.revokedReason]}),(0,s.jsxs)("p",{className:"text-sm text-red-600",children:["Revoked on: ",new Date(y.revokedAt).toLocaleString()]})]})]})}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Stamp Information"}),(0,s.jsxs)("dl",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Jurisdiction"}),(0,s.jsx)("dd",{className:"font-medium text-gray-900 capitalize",children:y.jurisdictionId.replace("-"," ")})]}),y.projectName&&(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Project Name"}),(0,s.jsx)("dd",{className:"font-medium text-gray-900",children:y.projectName})]}),y.permitNumber&&(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Permit Number"}),(0,s.jsx)("dd",{className:"font-medium text-gray-900",children:y.permitNumber})]}),y.documentFilename&&(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Document"}),(0,s.jsxs)("dd",{className:"font-medium text-gray-900",children:[y.documentFilename,y.documentSize&&(0,s.jsxs)("span",{className:"text-gray-500 ml-2",children:["(",(y.documentSize/1024/1024).toFixed(2)," MB)"]})]})]}),y.notes&&(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Notes"}),(0,s.jsx)("dd",{className:"text-gray-900",children:y.notes})]})]})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Blockchain Record"}),(0,s.jsxs)("dl",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Stamp ID"}),(0,s.jsx)("dd",{className:"font-mono text-sm text-gray-900",children:y.id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600",children:"Blockchain ID"}),(0,s.jsx)("dd",{className:"font-mono text-sm text-gray-900",children:y.blockchainId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-sm text-gray-600 mb-1",children:"Document Hash (SHA-256)"}),(0,s.jsxs)("dd",{className:"flex items-center gap-2",children:[(0,s.jsx)("code",{className:"flex-1 text-xs font-mono bg-gray-100 p-2 rounded break-all",children:y.documentHash}),(0,s.jsx)("button",{onClick:()=>{(null==y?void 0:y.documentHash)&&(navigator.clipboard.writeText(y.documentHash),R(!0),setTimeout(()=>R(!1),2e3))},className:"p-2 hover:bg-gray-100 rounded-lg",title:"Copy hash",children:C?(0,s.jsx)(o.A,{className:"h-4 w-4 text-accent"}):(0,s.jsx)(x,{className:"h-4 w-4 text-gray-500"})})]})]})]})]}),"active"===y.status&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Actions"}),(0,s.jsxs)(n.$,{variant:"danger",onClick:()=>w(!0),children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Revoke Stamp"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Revoking a stamp marks it as invalid. This action cannot be undone."})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:y.qrCodeDataUrl&&(0,s.jsxs)("div",{className:"card text-center",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Verification QR"}),(0,s.jsx)("img",{src:y.qrCodeDataUrl,alt:"Verification QR Code",className:"w-full max-w-[200px] mx-auto rounded-lg"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-4",children:"Scan to verify this stamp"}),y.verifyUrl&&(0,s.jsxs)("a",{href:y.verifyUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-cta hover:underline mt-2",children:["Open verification page",(0,s.jsx)(u.A,{className:"h-3 w-3 ml-1"})]})]})})]}),k&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Revoke Stamp"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Please provide a reason for revoking this stamp. This action cannot be undone."}),(0,s.jsx)("textarea",{className:"w-full rounded-lg border border-gray-300 p-3 mb-4",rows:3,placeholder:"Reason for revocation...",value:A,onChange:e=>S(e.target.value)}),(0,s.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,s.jsx)(n.$,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),(0,s.jsx)(n.$,{variant:"danger",onClick:T,disabled:!A||N,children:N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Revoking..."]}):"Revoke Stamp"})]})]})})]}):null}}},e=>{e.O(0,[987,441,964,358],()=>e(e.s=7130)),_N_E=e.O()}]);