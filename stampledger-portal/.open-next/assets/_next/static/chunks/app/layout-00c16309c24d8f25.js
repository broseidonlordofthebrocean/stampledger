(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{5695:(e,t,o)=>{"use strict";var r=o(8999);o.o(r,"usePathname")&&o.d(t,{usePathname:function(){return r.usePathname}}),o.o(r,"useRouter")&&o.d(t,{useRouter:function(){return r.useRouter}})},6052:(e,t,o)=>{"use strict";o.d(t,{A:()=>i,AuthProvider:()=>u});var r=o(5155),a=o(2115),n=o(5695);let s=(0,a.createContext)(void 0);function u(e){let{children:t}=e,[o,u]=(0,a.useState)(null),[i,l]=(0,a.useState)(null),[h,c]=(0,a.useState)(!0),d=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("token");e?(l(e),f(e)):c(!1)},[]);let f=async e=>{try{let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();u(e.user)}else localStorage.removeItem("token"),l(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("token"),l(null)}finally{c(!1)}},m=async(e,t)=>{let o=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!o.ok)throw Error((await o.json()).error||"Login failed");let r=await o.json();localStorage.setItem("token",r.token),l(r.token),u(r.user),d.push("/")},k=async e=>{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Registration failed");let o=await t.json();localStorage.setItem("token",o.token),l(o.token),u(o.user),d.push("/")};return(0,r.jsx)(s.Provider,{value:{user:o,token:i,loading:h,login:m,register:k,logout:()=>{localStorage.removeItem("token"),l(null),u(null),d.push("/login")}},children:t})}function i(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9324:()=>{},9918:(e,t,o)=>{Promise.resolve().then(o.t.bind(o,9324,23)),Promise.resolve().then(o.bind(o,6052))}},e=>{e.O(0,[533,441,964,358],()=>e(e.s=9918)),_N_E=e.O()}]);